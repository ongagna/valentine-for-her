<!doctype html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üíñ Notre plan de rendez-vous</title>
  <style>
    :root{
      --bg1:#0b1020;
      --bg2:#1b0b2a;
      --card:#0f172aee;
      --text:#f8fafc;
      --muted:#cbd5e1;
      --shadow: 0 20px 60px rgba(0,0,0,.45);
      --pink: rgba(251,113,133,1);
      --violet: rgba(167,139,250,1);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--text);
      background: radial-gradient(1200px 800px at 20% 20%, rgba(167,139,250,.25), transparent 60%),
                  radial-gradient(1000px 700px at 80% 70%, rgba(251,113,133,.25), transparent 60%),
                  linear-gradient(140deg, var(--bg1), var(--bg2));
      overflow:hidden;
    }
    .wrap{
      height:100%;
      display:grid;
      place-items:center;
      padding:24px;
      position:relative;
    }
    .card{
      width:min(980px, 94vw);
      background: var(--card);
      border: 1px solid rgba(148,163,184,.18);
      border-radius: 24px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      padding: 28px;
      position:relative;
      overflow:hidden;
    }
    .glow{
      position:absolute; inset:-80px;
      background: radial-gradient(circle at 30% 20%, rgba(251,113,133,.18), transparent 55%),
                  radial-gradient(circle at 75% 70%, rgba(167,139,250,.18), transparent 55%);
      filter: blur(18px);
      pointer-events:none;
    }
    h1{
      margin: 6px 0 10px;
      font-size: clamp(26px, 3.4vw, 42px);
      line-height:1.15;
      position:relative;
      z-index:1;
    }
    p{
      margin: 8px 0;
      color: var(--muted);
      font-size: 16px;
      line-height:1.6;
      position:relative;
      z-index:1;
    }
    .row{
      display:flex;
      gap:14px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
      position:relative;
      z-index:1;
      margin: 10px 0 18px;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius: 999px;
      background: rgba(2,6,23,.55);
      border: 1px solid rgba(148,163,184,.16);
      color: var(--muted);
      font-size: 13px;
    }
    .badge b{color:var(--text); font-weight:800}

    .plan{
      margin-top: 12px;
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 14px;
      position:relative;
      z-index:1;
    }
    .slot{
      grid-column: span 12;
      border-radius: 18px;
      border: 1px solid rgba(148,163,184,.16);
      background: rgba(2,6,23,.35);
      padding: 16px;
      position: relative;
    }
    .slot h2{
      margin:0 0 8px;
      font-size: 18px;
      letter-spacing: .2px;
    }
    .slot .meta{
      font-size: 13px;
      color: rgba(226,232,240,.85);
      margin-bottom: 10px;
    }
    .slot ul{
      margin: 0;
      padding-left: 18px;
      color: rgba(203,213,225,.95);
      line-height: 1.6;
    }
    .slot li{margin:4px 0}

    .grid2 .slot{grid-column: span 6}
    @media (max-width: 860px){
      .grid2 .slot{grid-column: span 12}
    }

    .actions{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      margin-top: 18px;
      position:relative;
      z-index:1;
    }
    button{
      cursor:pointer;
      border:none;
      border-radius: 16px;
      padding: 12px 16px;
      font-size: 15px;
      font-weight: 800;
      transition: transform .08s ease, filter .2s ease;
      user-select:none;
    }
    button:active{transform: scale(.98)}
    .primary{
      background: linear-gradient(135deg, rgba(251,113,133,1), rgba(167,139,250,.9));
      color: #0b1020;
      box-shadow: 0 16px 40px rgba(251,113,133,.18);
    }
    .secondary{
      background: rgba(148,163,184,.10);
      color: rgba(248,250,252,.92);
      border: 1px solid rgba(148,163,184,.22);
      font-weight:700;
    }
    .whatsapp{
      background: linear-gradient(135deg, rgba(34,197,94,1), rgba(34,197,94,.75));
      color: #052e16;
      box-shadow: 0 16px 40px rgba(34,197,94,.18);
    }
    .small{
      font-size: 12px;
      color: rgba(203,213,225,.7);
      margin-top: 10px;
      position:relative;
      z-index:1;
      min-height: 18px;
    }

    /* Confettis */
    .confetti{
      position:absolute;
      inset:0;
      pointer-events:none;
      overflow:hidden;
      z-index: 2;
    }
    .piece{
      position:absolute;
      width:10px;height:16px;
      border-radius: 4px;
      opacity:.95;
      animation: fall 1200ms ease-in forwards;
    }
    @keyframes fall{
      0%{transform: translateY(-30px) rotate(0deg); opacity:1}
      100%{transform: translateY(110vh) rotate(540deg); opacity:0}
    }

    /* Choix interactifs */
    .choices{display:flex; flex-direction:column; gap:10px; margin-top:10px;}
    .choice{
      width:100%;
      display:flex; align-items:center; gap:12px;
      text-align:left;
      padding:12px;
      border-radius:16px;
      background: rgba(2,6,23,.28);
      border: 1px solid rgba(148,163,184,.18);
      color: rgba(248,250,252,.95);
      cursor:pointer;
      transition: transform .08s ease, filter .2s ease, border-color .2s ease, background .2s ease, box-shadow .2s ease;
    }
    .choice:hover{ filter: brightness(1.08); border-color: rgba(148,163,184,.30); }
    .choice:active{ transform: scale(.99); }
    .choice .emoji{font-size:22px; width:34px; display:grid; place-items:center;}
    .choice .txt{display:flex; flex-direction:column; gap:2px; flex:1;}
    .choice .txt b{font-size:15px;}
    .choice .txt .sub{font-size:12.5px; color: rgba(203,213,225,.85);}
    .choice .tick{
      opacity:0; transform: scale(.9);
      transition: opacity .2s ease, transform .2s ease;
      font-weight:900; font-size:16px;
      color: rgba(248,250,252,.95);
    }
    .choice.selected{
      background: rgba(251,113,133,.12);
      border-color: rgba(251,113,133,.45);
      box-shadow: 0 14px 34px rgba(251,113,133,.10);
    }
    .choice.selected .tick{opacity:1; transform: scale(1);}
    .miniActions{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;}
    .miniBtn{
      border-radius:14px;
      padding:10px 12px;
      background: rgba(148,163,184,.10);
      color: rgba(248,250,252,.92);
      border: 1px solid rgba(148,163,184,.22);
      font-weight:800;
      font-size:13px;
    }
    .pickStatus{
      margin-top:10px;
      font-size:13px;
      color: rgba(226,232,240,.9);
      min-height:18px;
    }
    .stephNote{
      margin-top:8px;
      font-size:13px;
      color: rgba(248,250,252,.92);
      background: rgba(2,6,23,.25);
      border: 1px solid rgba(148,163,184,.14);
      padding:12px;
      border-radius:16px;
    }
    .stephNote b{color: rgba(248,250,252,.98)}

    /* Timeline anim√©e */
    .timelineHeader{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .timelineHeader .hint{
      font-size: 12px;
      color: rgba(203,213,225,.75);
    }
    .timeline{
      margin-top: 12px;
      position: relative;
      padding-left: 18px;
    }
    .timeline::before{
      content:"";
      position:absolute;
      left:7px;
      top:6px;
      bottom:6px;
      width:2px;
      background: linear-gradient(180deg, rgba(251,113,133,.55), rgba(167,139,250,.55));
      border-radius: 999px;
      opacity:.85;
      animation: pulseLine 2.2s ease-in-out infinite;
    }
    @keyframes pulseLine{
      0%,100%{filter: brightness(1); opacity:.75}
      50%{filter: brightness(1.25); opacity:1}
    }
    .tItem{
      position: relative;
      padding: 12px 12px 12px 16px;
      border-radius: 16px;
      border: 1px solid rgba(148,163,184,.12);
      background: rgba(2,6,23,.22);
      margin: 10px 0;
      overflow:hidden;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity .6s ease, transform .6s ease, border-color .25s ease, background .25s ease;
    }
    .tItem.show{opacity: 1; transform: translateY(0);}
    .tItem::before{
      content:"";
      position:absolute;
      left:-40px; top:-40px;
      width:120px; height:120px;
      background: radial-gradient(circle, rgba(251,113,133,.16), transparent 60%);
      filter: blur(6px);
      transform: rotate(18deg);
      pointer-events:none;
    }
    .dot{
      position:absolute;
      left:-18px;
      top: 16px;
      width: 12px; height: 12px;
      border-radius: 50%;
      background: linear-gradient(135deg, rgba(251,113,133,1), rgba(167,139,250,1));
      box-shadow: 0 10px 30px rgba(251,113,133,.18);
    }
    .tTop{
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      margin-bottom: 6px;
    }
    .tTime{
      font-weight: 900;
      font-size: 12.5px;
      color: rgba(226,232,240,.92);
      background: rgba(2,6,23,.25);
      border: 1px solid rgba(148,163,184,.12);
      border-radius: 999px;
      padding: 6px 10px;
    }
    .tTitle{
      font-weight: 900;
      font-size: 14.5px;
      color: rgba(248,250,252,.98);
      letter-spacing: .2px;
    }
    .tDesc{
      color: rgba(203,213,225,.9);
      font-size: 13.5px;
      line-height: 1.5;
    }
    .tItem.active{
      border-color: rgba(251,113,133,.42);
      background: rgba(251,113,133,.08);
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="glow"></div>

      <div class="row">
        <div class="badge">üíû <b>Plan de rendez-vous</b> ‚Ä¢ pr√©par√© pour <span id="herName">Dorlane chou</span></div>
        <div class="badge">üìç <span id="city">Paris</span> ‚Ä¢ üóìÔ∏è <span id="dateLabel">Saint-Valentin 2026</span></div>
      </div>

      <h1>Ch√©rie, on fait √ßa version ‚Äútrop mignon‚Äù ü•πüíñ</h1>
      <p>
        D√Æner cosy, activit√© fun, z√©ro stress (donc pas de ntouma j'ai compris hahah je te taquine). Tu peux tout ajuster ‚Äî moi je veux juste te voir sourire.
      </p>

      <div class="plan grid2">
        <div class="slot">
          <h2>üåÜ 1) D√©but doux : petite balade √† Paris</h2>
          <div class="meta">~18:00 ‚Ä¢ √©nergie ‚Äúsans pression‚Äù</div>
          <ul>
            <li>On se retrouve + un gros c√¢lin (obligatoire et non n√©gotiable üòå).</li>
            <li>On marche tranquillement, juste pour se mettre bien comme les whities.</li>
            <li>Mini jeu : chacun dit une chose qu‚Äôil appr√©cie chez l‚Äôautre.</li>
          </ul>
        </div>

        <div class="slot">
          <h2>üïØÔ∏è 2) D√Æner cosy (ton vibe)</h2>
          <div class="meta">~19:00 ‚Ä¢ bougies + douceur</div>
          <ul>
            <li>Un endroit intimiste : lumi√®re chaude, ambiance tranquille.</li>
            <li>On partage une entr√©e (oui oui, c‚Äôest mignon).</li>
            <li>Dessert obligatoire. On choisit ensemble.</li>
          </ul>
        </div>

        <div class="slot" id="funSlot">
          <h2>üéØ 3) Activit√© fun (tape pour choisir)</h2>
          <div class="meta">~20:45 ‚Ä¢ mode ‚Äúon rigole‚Äù activ√©</div>

          <div class="choices" role="group" aria-label="Choix d'activit√© fun">
            <button type="button" class="choice" data-choice="Arcade / jeux">
              <span class="emoji">üïπÔ∏è</span>
              <span class="txt">
                <b>Arcade / jeux</b>
                <span class="sub">Petit challenge + gros fous rires.</span>
              </span>
              <span class="tick" aria-hidden="true">‚úì</span>
            </button>

            <button type="button" class="choice" data-choice="Bowling / mini-golf">
              <span class="emoji">üé≥</span>
              <span class="txt">
                <b>Bowling / mini-golf</b>
                <span class="sub">Team Dorlane + Ch√©ri üòÑ</span>
              </span>
              <span class="tick" aria-hidden="true">‚úì</span>
            </button>

            <button type="button" class="choice" data-choice="Cabine photo (challenge)">
              <span class="emoji">üì∏</span>
              <span class="txt">
                <b>Cabine photo (challenge)</b>
                <span class="sub">3 photos, 3 humeurs, 1 souvenir.</span>
              </span>
              <span class="tick" aria-hidden="true">‚úì</span>
            </button>
          </div>

          <div class="miniActions">
            <button type="button" class="miniBtn" id="randomPick">üé≤ Choix au hasard</button>
            <button type="button" class="miniBtn" id="clearPick">‚úñ Effacer</button>
          </div>

          <div class="pickStatus" id="pickStatus"></div>
          <div class="stephNote" id="stephNote"><b>Note de ton ch√©ri :</b> Choisis ton activit√© et je m‚Äôadapte üòå</div>
        </div>

        <div class="slot">
          <h2>üåô 4) Fin cosy (tout doux)</h2>
          <div class="meta">~22:15 ‚Ä¢ calme + s√©curit√©</div>
          <ul>
            <li>Chocolat chaud / th√© dans un endroit tranquille.</li>
            <li>Je te donne une petite note √©crite √† la main.</li>
            <li>On termine par un long c√¢lin (toujours les c√¢lins, ah bas √ßa üòå).</li>
          </ul>
        </div>

        <div class="slot" style="grid-column: span 12;" id="timelineSlot">
          <div class="timelineHeader">
            <div>
              <h2 style="margin:0 0 6px;">üï∞Ô∏è Timeline du soir (anim√©e)</h2>
              <div class="meta" style="margin:0;">Une petite histoire en 4 moments.</div>
            </div>
            <div class="hint">Astuce : choisis une activit√© üéØ ‚Üí la timeline se met √† jour ‚ú®</div>
          </div>

          <div class="timeline" id="timeline"></div>
        </div>

        <div class="slot" style="grid-column: span 12;">
          <h2>‚ú® Tes pr√©f√©rences (mini check)</h2>
          <div class="meta">Tu choisis, j‚Äôajuste. Simple.</div>
          <ul>
            <li><b>D√Æner :</b> plut√¥t cuisine fran√ßaise / italienne / autre ?</li>
            <li><b>Activit√© :</b> tape ci-dessus pour choisir üéØ</li>
            <li><b>Heure :</b> plus t√¥t / plus tard ?</li>
          </ul>
        </div>
      </div>

      <div class="actions">
        <button class="primary" id="confirmBtn">J‚Äôadore üíñ</button>
        <button class="secondary" id="tweakBtn">On ajuste ‚ú®</button>
        <button class="whatsapp" id="whatsBtn">Envoyer sur WhatsApp üí¨</button>
        <button class="secondary" id="backBtn">Retour</button>
      </div>

      <div class="small" id="status"></div>
      <div class="confetti" id="confetti"></div>
    </div>
  </div>

  <!-- Overlay musique sur la page 2 (iPhone: clic requis aussi) -->
  <div id="musicGate2" style="
    position:fixed; inset:0; z-index:9999;
    display:none;
    align-items:center; justify-content:center;
    padding:24px;
    background: radial-gradient(900px 600px at 30% 20%, rgba(167,139,250,.25), transparent 60%),
                radial-gradient(800px 600px at 70% 80%, rgba(251,113,133,.25), transparent 60%),
                rgba(2,6,23,.88);
    backdrop-filter: blur(8px);
  ">
    <div style="
      width:min(560px, 94vw);
      border-radius:24px;
      border:1px solid rgba(148,163,184,.18);
      background: rgba(15,23,42,.92);
      box-shadow: 0 20px 60px rgba(0,0,0,.45);
      padding:22px;
      text-align:center;
    ">
      <div style="font-size:28px; margin-bottom:8px;">üéµüíñ</div>
      <div style="font-weight:900; font-size:18px; margin-bottom:6px;">
        Reprendre la musique ?
      </div>
      <div style="color: rgba(203,213,225,.9); font-size:14px; line-height:1.5; margin-bottom:14px;">
        Tu dois cliquer pour relancer la musique sur cette page.
      </div>

      <button id="resumeMusicBtn" style="
        cursor:pointer;
        border:none;
        border-radius:16px;
        padding:12px 16px;
        font-size:15px;
        font-weight:900;
        background: linear-gradient(135deg, rgba(34,197,94,1), rgba(34,197,94,.75));
        color:#052e16;
        box-shadow: 0 16px 40px rgba(34,197,94,.18);
        width:100%;
      ">Reprendre la musique</button>

      <button id="noMusicBtn" style="
        cursor:pointer;
        margin-top:10px;
        border-radius:16px;
        padding:12px 16px;
        font-size:14px;
        font-weight:800;
        background: rgba(148,163,184,.10);
        color: rgba(248,250,252,.92);
        border: 1px solid rgba(148,163,184,.22);
        width:100%;
      ">Rester sans musique</button>
    </div>
  </div>

  <!-- Player YouTube cach√© -->
  <div id="ytWrap2" style="position:fixed; width:1px; height:1px; overflow:hidden; left:-9999px; top:-9999px;">
    <div id="ytPlayer2"></div>
  </div>
  <script src="https://www.youtube.com/iframe_api"></script>

  <script>
    const HER_NAME = "Dorlane";
    const CITY = "Paris";
    const DATE_LABEL = "Saint-Valentin";

    // WhatsApp (format international sans "+")
    const WHATSAPP_NUMBER = "41792667698";

    document.getElementById("herName").textContent = HER_NAME;
    document.getElementById("city").textContent = CITY;
    document.getElementById("dateLabel").textContent = DATE_LABEL;

    const status = document.getElementById("status");
    const confettiEl = document.getElementById("confetti");

    function confetti(intensity = 120){
      for(let i=0;i<intensity;i++){
        const p = document.createElement("div");
        p.className = "piece";
        p.style.left = (Math.random()*100) + "vw";
        p.style.top = (-20 - Math.random()*40) + "px";
        p.style.animationDuration = (900 + Math.random()*800) + "ms";
        const hue = Math.floor(Math.random()*360);
        p.style.background = `hsl(${hue} 90% 65%)`;
        confettiEl.appendChild(p);
        setTimeout(()=>p.remove(), 2000);
      }
    }
    confetti(90);

    // Affiche si ‚ÄúOui‚Äù a √©t√© enregistr√©
    try{
      const choice = localStorage.getItem("valentine_choice");
      const t = localStorage.getItem("valentine_choice_time");
      if(choice === "yes"){
        status.textContent = `Enregistr√© : OUI ‚úÖ ${t ? "‚Ä¢ " + new Date(t).toLocaleString() : ""}`;
      }
    }catch(e){}

    // ===== Timeline =====
    const timelineEl = document.getElementById("timeline");

    function timelineData(activity){
      const actLine = activity
        ? `On part sur : <b>${activity}</b> üòÑ`
        : "On choisit l‚Äôactivit√© ensemble‚Ä¶ ou tu tapes plus haut üéØ";

      return [
        { time:"18:00", title:"Balade & c√¢lin", desc:"On se retrouve, on se met bien. T√©l√©phones en mode discret 20 minutes. Juste nous." },
        { time:"19:00", title:"D√Æner cosy", desc:"Ambiance bougies. On partage une entr√©e. Dessert obligatoire (on choisit ensemble)." },
        { time:"20:45", title:"Activit√© fun", desc: actLine },
        { time:"22:15", title:"Fin douce", desc:"Boisson chaude + petite note √©crite √† la main. Long c√¢lin, et ‚Äú√† tr√®s vite‚Äù." }
      ];
    }

    function renderTimeline(activity){
      timelineEl.innerHTML = "";
      const items = timelineData(activity);

      items.forEach((it, idx) => {
        const div = document.createElement("div");
        div.className = "tItem";
        div.innerHTML = `
          <div class="dot"></div>
          <div class="tTop">
            <div class="tTitle">${it.title}</div>
            <div class="tTime">${it.time}</div>
          </div>
          <div class="tDesc">${it.desc}</div>
        `;
        timelineEl.appendChild(div);
        setTimeout(() => div.classList.add("show"), 120 + idx * 140);
      });

      if(activity){
        const third = timelineEl.querySelectorAll(".tItem")[2];
        if(third) third.classList.add("active");
      }
    }

    // ===== WhatsApp =====
    function buildWhatsappUrl(){
      const activity = (localStorage.getItem("fun_activity_choice") || "").trim();
      const when = DATE_LABEL ? `pour ${DATE_LABEL}` : "pour notre date";
      const activityLine = activity ? `J‚Äôai choisi l‚Äôactivit√© : ${activity} üéØ` : "Je n‚Äôai pas encore choisi l‚Äôactivit√© üéØ";
      const msg =
        `Coucou Steph üíñ\n` +
        `J‚Äôai vu ton plan √† Paris‚Ä¶ et j‚Äôadore ü•π‚ú®\n` +
        `${activityLine}\n` +
        `On se fait √ßa ${when} ? üòò`;
      return `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`;
    }

    document.getElementById("whatsBtn").addEventListener("click", ()=>{
      confetti(70);
      window.open(buildWhatsappUrl(), "_blank", "noopener,noreferrer");
    });

    // ===== Boutons bas =====
    document.getElementById("confirmBtn").addEventListener("click", ()=>{
      confetti(140);
      const activity = (localStorage.getItem("fun_activity_choice") || "").trim();
      const extra = activity ? ` (activit√© : ${activity})` : "";
      status.textContent = `Yesss üíñ Tu peux me faire une capture d‚Äô√©cran : ‚ÄúJ‚Äôadore‚Äù${extra} üòå`;
      try{ localStorage.setItem("date_plan_response","jadore"); }catch(e){}
    });

    document.getElementById("tweakBtn").addEventListener("click", ()=>{
      const activity = (localStorage.getItem("fun_activity_choice") || "").trim();
      status.textContent = activity
        ? `Ok ‚ú® Tu veux ajuster quoi ? (on garde ${activity} ou tu changes ?)`
        : "Ok ‚ú® Tu veux ajuster quoi ? D√Æner, activit√©, horaire‚Ä¶ je m‚Äôadapte.";
      try{ localStorage.setItem("date_plan_response","ajuster"); }catch(e){}
    });

    document.getElementById("backBtn").addEventListener("click", ()=>{
      window.location.href = "./index.html";
    });

    // ===== Activit√© interactive =====
    const choiceButtons = Array.from(document.querySelectorAll(".choice"));
    const pickStatus = document.getElementById("pickStatus");
    const randomPickBtn = document.getElementById("randomPick");
    const clearPickBtn = document.getElementById("clearPick");
    const stephNote = document.getElementById("stephNote");

    const notesByChoice = {
      "Arcade / jeux": "Arcade ? Ok‚Ä¶ je viens avec mon sourire ‚Äúje te laisse gagner (peut-√™tre)‚Äù üòÑ",
      "Bowling / mini-golf": "Team Dorlane + Steph üòÑ Pr√©pare-toi : je c√©l√®bre tes points comme si c‚Äô√©tait la coupe du monde.",
      "Cabine photo (challenge)": "Cabine photo‚Ä¶ parfait. Je veux qu‚Äôon reparte avec un souvenir qu‚Äôon garde longtemps. üì∏üíñ"
    };

    function setSelected(choiceText){
      choiceButtons.forEach(btn => {
        const isSel = btn.dataset.choice === choiceText;
        btn.classList.toggle("selected", isSel);
        btn.setAttribute("aria-pressed", isSel ? "true" : "false");
      });

      if(choiceText){
        pickStatus.textContent = `Choisi : ${choiceText} ‚úÖ`;
        try{ localStorage.setItem("fun_activity_choice", choiceText); }catch(e){}
        stephNote.innerHTML = `<b>Note de Steph :</b> ${notesByChoice[choiceText] || "Parfait. Je m‚Äôoccupe du reste üòå"}`;
        confetti(50);
        renderTimeline(choiceText);
      }else{
        pickStatus.textContent = "";
        try{ localStorage.removeItem("fun_activity_choice"); }catch(e){}
        stephNote.innerHTML = "<b>Note de Steph :</b> Choisis ton activit√© et je m‚Äôadapte üòå";
        renderTimeline("");
      }
    }

    choiceButtons.forEach(btn => {
      btn.setAttribute("aria-pressed", "false");
      btn.addEventListener("click", () => setSelected(btn.dataset.choice));
    });

    // restore choix activit√© + timeline
    let saved = "";
    try{
      saved = (localStorage.getItem("fun_activity_choice") || "").trim();
      if(saved) setSelected(saved);
    }catch(e){}
    if(!saved) renderTimeline("");

    randomPickBtn?.addEventListener("click", () => {
      const options = choiceButtons.map(b => b.dataset.choice);
      const pick = options[Math.floor(Math.random() * options.length)];
      setSelected(pick);
    });

    clearPickBtn?.addEventListener("click", () => setSelected(null));

    // ===== Musique YouTube sur date.html =====
    let ytPlayer2 = null;
    const YT_VIDEO_ID = "hLQl3WQQoQ0"; // Adele - Someone Like You
    const musicGate2 = document.getElementById("musicGate2");
    const resumeMusicBtn = document.getElementById("resumeMusicBtn");
    const noMusicBtn = document.getElementById("noMusicBtn");

    // Pr√©f√©rence depuis index.html
    function getMusicPref(){
      try { return localStorage.getItem("music_pref") || "off"; } catch(e) { return "off"; }
    }
    function setMusicPref(pref){
      try { localStorage.setItem("music_pref", pref); } catch(e) {}
    }

    // NOTE: sur iPhone, il faut un clic sur cette page aussi -> on affiche le gate si pref = on
    const pref = getMusicPref();
    if(pref === "on"){
      musicGate2.style.display = "flex";
    } else {
      musicGate2.style.display = "none";
    }

    // YouTube API callback global (2√®me page)
    window.onYouTubeIframeAPIReady = function () {
      ytPlayer2 = new YT.Player("ytPlayer2", {
        height: "1",
        width: "1",
        videoId: YT_VIDEO_ID,
        playerVars: {
          autoplay: 0,
          controls: 0,
          disablekb: 1,
          fs: 0,
          modestbranding: 1,
          loop: 1,
          playlist: YT_VIDEO_ID
        },
        events: { onReady: () => {} }
      });
    };

    function startYT2(){
      if(!ytPlayer2) return;
      try{
        ytPlayer2.unMute();
        ytPlayer2.setVolume(55);
        ytPlayer2.playVideo();
      }catch(e){}
    }
    function stopYT2(){
      if(!ytPlayer2) return;
      try{ ytPlayer2.stopVideo(); }catch(e){}
    }

    resumeMusicBtn.addEventListener("click", () => {
      setMusicPref("on");
      startYT2();
      musicGate2.style.display = "none";
    });

    noMusicBtn.addEventListener("click", () => {
      setMusicPref("off");
      stopYT2();
      musicGate2.style.display = "none";
    });
  </script>
</body>
</html>
